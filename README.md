# rStudi
# Recipe 1 - Estimating differential expression with edgeR  ## Count table  ### Load data count_dataframe &lt;- readr::read_tsv(file.path(getwd(), "datasets", "ch1", "modencodefly_count_table.txt" )) genes &lt;- count_dataframe[['gene']] count_dataframe[['gene']] &lt;- NULL count_matrix &lt;- as.matrix(count_dataframe) rownames(count_matrix) &lt;- genes pheno_data &lt;- readr::read_table2(file.path(getwd(), "datasets", "ch1", "modencodefly_phenodata.txt"))   ### Specify experiments of interest   experiments_of_interest &lt;- c("L1Larvae", "L2Larvae") columns_of_interest &lt;- which( pheno_data[['stage']] %in% experiments_of_interest ) #gives the numeric indices of the above experiments in the matrix  ### Form grouping factor library(magrittr) grouping &lt;- pheno_data[['stage']][columns_of_interest] %>%    forcats::as_factor()  ### Form subset count data counts_of_interest &lt;-  count_matrix[,columns_of_interest]  ### Form DGE library(edgeR) count_dge &lt;- edgeR::DGEList(counts = counts_of_interest, group = grouping)   ### Perform differential expression  design &lt;- model.matrix(~ grouping) eset_dge &lt;- edgeR::estimateDisp(count_dge, design) fit &lt;- edgeR::glmQLFit(eset_dge, design) result &lt;- edgeR::glmQLFTest(fit, coef=2) topTags(result)   ##eset load(file.path(getwd(), "datasets/ch1/modencodefly_eset.RData"))  experiments_of_interest &lt;- c("L1Larvae", "L2Larvae") columns_of_interest &lt;- which( phenoData(modencodefly.eset)[['stage']] %in% experiments_of_interest )  grouping &lt;- droplevels(phenoData(modencodefly.eset)[['stage']][columns_of_interest] )  counts_of_interest &lt;- exprs(modencodefly.eset)[, columns_of_interest]  eset_dge &lt;- edgeR::DGEList(   counts = counts_of_interest,   group = grouping    )  design &lt;- model.matrix(~ grouping) eset_dge &lt;- edgeR::estimateDisp(eset_dge, design) fit &lt;- edgeR::glmQLFit(eset_dge, design) result &lt;- edgeR::glmQLFTest(fit, coef=2) topTags(result)
